@model IEnumerable<RentCarUser>
<div class="hero inner-page" style="background-image: url('/images/hero_1_a.jpg');">
  <div class="container">
    <div class="row align-items-end">
      <div class="col-lg-5">
        <div class="intro">
          <h1><strong>Users</strong></h1>
          <div class="custom-breadcrumbs"><a>Admin</a> <span class="mx-2">/</span> <strong>Users</strong></div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="site-section">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <h2 class="mb-4">Manage Users</h2>

        <div class="table-responsive">
          <table class="table table-striped">
            <thead>
              <tr>
                <th>Username</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>EGN</th>
                <th>Phone Number</th>
                <th>Email</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              @foreach (var user in Model)
              {
                <tr>
                  <td>@user.UserName</td>
                  <td>@user.FirstName</td>
                  <td>@user.LastName</td>
                  <td>@user.UniqueCitinzenshipNumber</td>
                  <td>@user.PhoneNumber</td>
                  <td>@user.Email</td>
                  <td>
                    <button type="button" class="btn btn-success btn-sm" onclick="window.location.href='@Url.Action("Edit", "Users", new { id = @user.Id })'">Edit user</button>
                    <a asp-action="UserReservations" asp-controller="Reservations" asp-route-id="@user.Id" class="btn btn-info btn-md">See Rents</a>
                    <button class="btn btn-danger btn-sm" onclick="deleteUser('@user.Id')">Delete</button>
                  </td>
                </tr>
              }
            </tbody>
          </table>
          <div class="text-center">
            <button type="button" class="btn btn-primary mb-4" id="addCarBtn" onclick="window.location.href='@Url.Action("Create", "Users")'">Add user</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

@section Scripts {
    <script>
        function deleteUser(id) {
            console.log('Posting data with ID:', id);
            $.ajax({
                type: "POST",
                url: `/users/delete/${encodeURIComponent(id)}`,
                success: function (result) {
                    console.log('POST request successful');
                    window.location.reload();
                },
                error: function (xhr, status, error) {
                    console.error('Error:', error);
                }
            });
        }
    </script>
}